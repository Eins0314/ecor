---
title: "ch4.4.6"
---

```{r, echo=FALSE}
require(Matrix)
```

<h3> 4.4.6 선형등식체계 해 </h3>

linear equation system 은 표현형태 

> Ax = h

계수행렬(coefficient matrix) A 는 m x n 이고,

변수행렬 x는 n x 1 이고,

상수행렬 h는 m x 1 형태를 갖는다.

> x = A^^-1^^h

만약 A 가 정방행렬이고 비특이행렬이면,

역행렬이 존재하고, 따라서 해는 유일하다.

```{r}
A <- matrix(c(3,5,4,2), nrow=2, byrow=T)
h <- matrix(c(13,8), nrow=2)
det(A)
solve(A)%*%h
solve(A,h)

# 해를 도출할 수 없는 경우
X <- matrix(c(2,3,5,3,2,5,4,5,9), nrow=3)
b <- matrix(c(20,22,42), nrow=3)
det(X)
#solve(X)%*%b # 실행하면 에러 발생 = 해 도출 불가
## Error in solve.default(X) : 
##  system is computationally singular: reciprocal condition number = 5.50706e-18

```


<br>
----------

<h3> 4.4.7 고유값(eigenvalue) 과 고유벡터(eigenvector) </h3>

p316 (내용을 잘못 이해하고 적었을 수 있음 -_-; 주의바람!)

행렬 A (n x n) 와 스칼라 L(lambda)

> Ax = Lx

> (A - LI)x = 0  # (숫자0 아니고 0행렬)

위 형태는 n개 미지수와 n개 방정식으로 구성된 동차선형계로 볼 수 있다.

아래 명제들은 같다.

(A - LI) 가 특이행렬이다.

=> |A-LI| = 0

=> 비자명해 (nontrivial solution) 를 갖는다. 

=> x 가 0행렬이 아닌 행렬을 갖는다.

=> **이때 0행렬이 아닌 x 를 고유벡터라고 한다.**

=> **이때의 L 값을 고유값이라고 한다.**

<br>

x 의 비자명해를 구하려면,

우선 |A-LI| = 0 이여야 한다.

그럼 L 에 대한 다항식이 나온다.

이때 다항식의 차수는 A 가 n x n 행렬이면 n 차 다항식이다.

<br>

예를들어, A 행렬이 아래와 같으면,
```{r, echo=FALSE}
A <- matrix(c(4,-2,1,1), nrow=2, byrow=T)
A
```


고유행렬식은 

> |A-LI| = (4-L)(1-L) + 2 = L^^2^^-5L+6

으로 L 의 2차 다항식이다. 

L^^2^^-5L+6 = (L-2)(L-3) = 0

만족하는 L 은 3, 2 이다.

<br>

우선 L 에 첫번째값 3을 넣고 풀면, x 해가 무수히 많은데,

단위 길이 1 이라는 x<sub>1</sub>^^2^^ + x<sub>2</sub>^^2^^ = 1 제약조건을 추가하면,

x<sub>1</sub> = 2/sqrt(5), x<sub>2</sub> = 1/sqrt(5)

가 나온다.

마찬가지로 L 에 2를 넣고 풀면,

x<sub>1</sub> = 1/sqrt(2), x<sub>2</sub> = 1/sqrt(2)

```{r}
A <- matrix(c(4,1,-2,1), nrow=2)
A
eigen(A)
```


<br>
----------

<h3> 4.4.8 직교행렬과 대칭행렬의 대각화 </h3>

A 가 대칭행렬이면, 고유값은 실수이고, (복소수 아님)

각 고유값에 대응되는 고유벡터는 직교(orthogonal) 한다.



모두 다른 n 개 고유값에 대응되는 고유벡터로 구성된 

행렬 X = (x<sub>1</sub>,x<sub>2</sub>,...,x<sub>n</sub>) 은 

직교행렬(orthogonal matrix) 이다.

따라서 X 의 전치행렬 = X 의 역행렬이다.

> X'X = XX' = I , X' = X^^-1^^


```{r}
a <- 1/sqrt(2)
X <- matrix(c(a,a,-a,a), ncol=2)
round(t(X)%*%X)
t(X); solve(X)  # 전치행렬과 역행렬이 같다.
```

n x n  A행렬이 대칭행렬이면,

X'AX 를 대각행렬로 만드는 직교행렬 X 가 존재한다.

> AX = XA_

> X'AX = X'X A_ = A_

그럼 주대각선에 A 의 고유값을 갖는 대각행렬 A_이 만들어진다.

이것을 대칭행렬의 대각화 (diagonalization) 이라 한다.


```{r}
# 대칭행렬
A <- matrix(c(2,1,1,2), ncol=2)  

# 직교행렬 생성
X <- matrix(c(1,1,-1,1), ncol=2)
X <- X* 1/sqrt(2)

# 고유값이 대각에 모여있음
round(t(X) %*% A %*% X)

```

**직교행렬 속성**

> 직교행렬의 고유값은 +1, -1 

> 직교행렬 A 의 전치행렬 A' 와 역행렬 A^^-1^^ 도 직교행렬이다

> 직교행렬의 행렬식은 +1 이거나 -1 이다


<br>
----------

<h3> 4.4.9 멱등행렬 </h3>

A = A' 와 A = A^^2^^ 를 만족하면 멱등행렬(idempotent matrix)

0 행렬과 I 행렬이 멱등행렬

> M = I - X(X'X)^^-1^^X'

멱등행렬은 대칭행렬이기도 하다.

**멱등행렬 속성**

> 멱등행렬 고유값은 1 또는 0 이다

> A 가 멱등행렬이면, I - A 도 멱등행렬이다.


<br>
----------

<h3> 4.4.10 이차형태 </h3>

행렬 A 와 벡터 a, x 에 대해서 

L = a'x 을 x 의 일차형태(linear form)이라 하고,

대칭행렬 A 와 벡터 x 에 의해 정의된 스칼라 Q

Q = x'Ax

는 x에 대한 이차형태(quadratic form)이라 한다.

... 복잡하다 @_@

편미분 dQ/dx = Ax + A'x = (A + A')x 


<br>
----------

<h3> 4.4.11 확률변수 집합의 공분산행렬 </h3>

가자~ 달나라로!


<br>
----------

<h3> 4.4.12 콜레스키 분해 </h3>


<br>
----------

<h3> 4.4.13 QR 분해 </h3>


<br>
----------

<h3> 4.4.14 특이값 분해 </h3>


<br>
----------

<h3> 4.4.15 벡터 및 행렬 노옴 </h3>

